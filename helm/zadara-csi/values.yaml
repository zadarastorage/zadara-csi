---
# -- namespace where all CSI pods will run
namespace: "kube-system"

image:
  # -- csiDriver is the main CSI container, provided by Zadara.
  # `repository` and `tag` are used similarly for all images below.
  csiDriver:
    # -- repository to pull image from, Dockerhub by default.
    # Also available at `registry.connect.redhat.com/zadara/csi`
    repository: zadara/csi-driver
    # -- image tag. Modifying tags is not recommended and may cause compatibility issues.
    tag: 1.3.10
  provisioner:
    repository: k8s.gcr.io/sig-storage/csi-provisioner
    # -- last tag that supports restoring DEPRECATED v1alpha1 snapshots is v1.4.0
    tag: v2.2.2
  attacher:
    repository: k8s.gcr.io/sig-storage/csi-attacher
    tag: v3.2.1
  resizer:
    repository: k8s.gcr.io/sig-storage/csi-resizer
    tag: v1.2.0
  livenessProbe:
    repository: k8s.gcr.io/sig-storage/livenessprobe
    tag: v2.3.0
  nodeDriverRegistrar:
    repository: k8s.gcr.io/sig-storage/csi-node-driver-registrar
    tag: v2.2.0
  snapshotter:
    repository: k8s.gcr.io/sig-storage/csi-snapshotter
    # -- `tagV1` will be used with `snapshots.apiVersion` `v1` (or when `auto` resolves to `v1`)
    tagV1: v4.1.1
    # -- `tagV1Beta1` will be used with `snapshots.apiVersion` `v1beta1` (or when `auto` resolves to `v1beta1`)
    tagV1Beta1: v3.0.3
    # -- DEPRECATED: `tagV1Alpha1` will be used with `snapshots.apiVersion` `v1alpha1`.
    tagV1Alpha1: v1.2.2

# -- imagePullSecrets: credentials for private registry. A list of names of Secrets in the same namespace.
# Create `imagePullSecrets`: https://kubernetes.io/docs/tasks/configure-pod-container/pull-image-private-registry/
imagePullSecrets: []
# -- imagePullPolicy *for all images* used by this chart
imagePullPolicy: IfNotPresent

vpsa:
  # -- url or IP of VPSA provisioning Volumes, without "http(s)://" prefix
  url: "example.zadaravpsa.com"
  # -- VPSA public IP. Setting this will force CSI driver to connect to VPSA via public IP.
  publicIP: ""
  # -- useTLS defines whether to use TLS (HTTPS) to access VPSA
  useTLS: true
  # -- verifyTLS defines whether to verify TLS certificate when using HTTPS
  verifyTLS: true
  # -- token to access VPSA
  token: "FAKETOKEN1234567-123"

plugin:
  # -- controllerReplicas is number of replicas of Controller Deployment (responsible for provisioning and attaching volumes)
  controllerReplicas: 1
  # -- provisioner is the name of CSI plugin, for use in StorageClass, e.g. `us-west.csi.zadara.com`, `on-prem.csi.zadara.com`
  provisioner: csi.zadara.com
  # -- iscsiMode (`rootfs` or `client-server`) allows to chose a way for the plugin to reach iscsiadm on host
  iscsiMode: "rootfs"
  # -- healthzPort is used for Node liveness probe, needs to be unique for each plugin instance in a cluster
  # (Node pod requires `hostNetwork` for iSCSI support, thus using ports on the Node).
  healthzPort: 9808
  autoExpandSupport:
    # -- enable or disable autoExpandSupport: will create a CronJob for periodical capacity sync between VPSA Volumes and K8s PVCs
    enable: true
    # -- schedule for periodical capacity sync in cron format
    schedule: "*/10 * * * *"
  stonith:
    # -- enable or disable STONITH for fast failover for stateful Pods.
    # Limited to Pods using Persistent Volume Claims provisioned by this CSI driver.
    enable: true
    # -- When Node is not ready, STONITH will probe it with this interval.
    # Format: [time.Duration](https://pkg.go.dev/time#ParseDuration) e.g. 10s, 1m, 500ms
    probePeriod: "2s"
    # -- STONITH will start evacuating pods if Node is still not ready after this timeout.
    #  Format: [time.Duration](https://pkg.go.dev/time#ParseDuration) e.g. 10s, 1m, 500ms
    probeTimeout: "15s"
    # -- selfEvacuateTimeoutSeconds determines `tolerations` timeouts for STONITH's own Pod.
    selfEvacuateTimeoutSeconds: 15

# -- snapshots support: requires common one-per-cluster snapshots controller.
# Install from `helm/snapshots-v1[beta1]` chart in this repo.
# More info: https://kubernetes.io/blog/2020/12/10/kubernetes-1.20-volume-snapshot-moves-to-ga/
snapshots:
  # -- apiVersion for CSI Snapshots: `v1beta1`, `v1` (requires K8s >=1.20) or "auto" (based on installed CRDs and k8s version)
  # Deprecated option: `v1alpha1`, requires `RemoveSelfLink=false` feature gate.
  apiVersion: auto

# -- labels to attach to all Zadara-CSI objects, can be extended with any number of arbitrary 'key: "value"' pairs
labels:
  stage: "production"

# -- additional customTrustedCertificates to install in CSI pods. Use either `existingSecret` or `plainText`.
customTrustedCertificates: {}
#    # -- existingSecret: name of an existing secret from the same namespace, each key containing a pem-encoded certificate
#    existingSecret: my-root-ca
#    # -- plainText: create a new secret with the following contents
#    plainText: |-
#      -----BEGIN CERTIFICATE-----
#      ...
#      -----END CERTIFICATE-----
